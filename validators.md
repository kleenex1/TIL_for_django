
# 데이터 유효성 검사

## 1. Field 인자로 유효성 검증하기(내장 Field 옵션)

1. models.py에서 Django에서 기본옵션인자를 이용하여 유효성 검증
	-  blank : 폼에서 비어있는 값을 허용할지? (기본옵션: blank=False 빈칸을 허용하지 않는다)
	-  null: 빈 값을 null로 저장하는 걸 허용할지? 
2. 빈문자열을 허용할때는 주의해야하는데 장고에서는 문자열필드에서는 빈문자열을 ""로 표현하는것을 권장한다. blank=True로 하면 빈문자열이 저장된다. (null=True로 하는것은 권장되지 않는다.)


#### 예시 

 * 모델필드 기본옵션을 이용해 유효성검사 - 유니크라는 에러가 발생하면 이런 에러메시지를 발생시켜줘(장고 내장옵션)
![1](./validators/%EC%A0%9C%EB%AA%A9%20%EC%97%86%EC%9D%8C.png)

 ## 2. Validator로 유효성 검증하기
 * 데이터에 복잡한 유효성 검사가 필요하다면?
 * Validator(유효성검사기)는 임의의 값을 받아서 내부의 기준을 충ㅇ족하지 않으면 ValidationError를 발생시키는 함수이다.
![2](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20103104.png)
##### 1. 장고 django built-in validator 라고 검색한 후 from / import 해준다
![3](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20103453.png)

##### 2. 내가 Validator를 구현 할 수 있다.
* 새로 validators.py 만들고, 정의를 해준다
![4](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20103705.png)

## Form에서 유효성검사하기
![5](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20104451.png)
* model에서 썼던 필드 옵션과 validator들은 Form에서도 쓸수 있다.

![6](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20104733.png)
* 필드를 정의할때 유효성검사를 하는것 외에 다른방법으로 하는 방법도있다.
* clean_필드네임 을 사용하는것이다. 
* 클래스 안쪽에서 데이터를 설정하는 것이니 self로 해주고, cleaned_data에는 폼 필드를 정의할때 넣어준 유효성 검증을 통과한 데이터가 들어가있다. 만약 폼필드를 사용하지 않았다면 유저가 입력한 데이터가 그대로 넘어온다. 여기서는 모델 필드에 유효성 검사를 넣어줬기 때문에 cleaned_data안에는 유효성 검사가 이루어지지 않은 상태다(유저 입력값 그대로임) 그래서 title에다가 유효성 검사를 해주는것이다.
* 이러한 clean_필드 가 벨리데이터와 다른점은 하나의 필드만 검증이 가능하며 유효성 검증에러를 내는것과 관계없이 항상 return title을 해서 cleaned_data에서 가져온 데이터를 return해줘야 한다.
* 그에 반해 validator는 한번 정의하면 model과 form에서 사용가능하고 여러필드에서 사용가능하다.
![7](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20104837.png)
* 보면 유효성 검증을 추가해주는 단계가 여러개 있다. form 유효성 검증을 하고 나서 model검증을 한다. 
* form에 form field가 먼저 되어있다면 각각의 field에 정의에사용된  유효성 검증을 먼저하고 clean_필드 이용해서 유효성 검증을 하게 된다. 내가 처리하는 데이터를 어디서 어떤 유효성 검증을 하면 좋을지 각 단계별로 검증을 하면 된다.

# 유효성 검증을 뒤늦게 추가했다면?

![8](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20132604.png)
* shell 환경에서 해당 validate_post를 실행한다.
![9](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20133010.png)
![10](./validators/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202022-11-09%20133109.png)